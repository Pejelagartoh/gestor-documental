<mat-card class="mat-elevation-z4 p-4">
  <mat-card-header>
    <mat-card-title class="text-2xl font-bold text-indigo-700">
      Documentos de Salida
    </mat-card-title>
    <button
      mat-raised-button
      color="primary"
      (click)="openAddDialog()"
      class="ml-auto bg-indigo-600 hover:bg-indigo-700 text-white"
    >
      <mat-icon>add</mat-icon> Nuevo Documento
    </button>
  </mat-card-header>

  <mat-card-content class="mt-4">
    @if (documents.length > 0) {
      <div class="overflow-x-auto">
        <table mat-table [dataSource]="documents" class="mat-elevation-z2 w-full">

          <!-- Definición de todas las columnas dinámicamente -->
          @for (column of displayedColumns; track column) {

            <!-- Columna de Acciones (Botones) -->
            @if (column === 'acciones') {
              <ng-container matColumnDef="acciones">
                <th mat-header-cell *matHeaderCellDef>Acciones</th>
                <td mat-cell *matCellDef="let element" class="flex space-x-2">
                  <!-- Botón Editar -->
                  <button
                    mat-icon-button
                    color="accent"
                    (click)="editDocument(element)"
                    title="Editar Documento"
                  >
                    <mat-icon>edit</mat-icon>
                  </button>
                  <!-- Botón Eliminar -->
                  <button
                    mat-icon-button
                    color="warn"
                    (click)="deleteDocument(element.id!)"
                    title="Eliminar Documento"
                  >
                    <mat-icon>delete</mat-icon>
                  </button>
                </td>
              </ng-container>
            } @else if (column === 'instruyeRespuesta') {
              <!-- Columna para formato Booleano (Instruye Respuesta -> Sí/No) -->
              <ng-container matColumnDef="instruyeRespuesta">
                <th mat-header-cell *matHeaderCellDef>Incluye</th>
                <td mat-cell *matCellDef="let element">{{ formatBoolean(element.instruyeRespuesta) }}</td>
              </ng-container>
            } @else if (column === 'archivo') {
              <!-- Columna para enlace de archivo -->
              <ng-container matColumnDef="archivo">
                <th mat-header-cell *matHeaderCellDef>Documento</th>
                <td mat-cell *matCellDef="let element">
                  @if (element.archivo) {
                    <a [href]="element.archivo" target="_blank" class="text-indigo-500 hover:text-indigo-700 underline">
                      Ver
                    </a>
                  } @else {
                    -
                  }
                </td>
              </ng-container>
            } @else {
              <!-- Columna genérica para texto -->
              <ng-container matColumnDef="{{ column }}">
                <!-- Aquí ajustamos el texto del encabezado para que se vea mejor en la tabla -->
                <th mat-header-cell *matHeaderCellDef>
                  {{
                    column === 'registroSalida' ? 'Nro. LOE' :
                      column === 'materiaDocumento' ? 'Materia' :
                        column | uppercase
                  }}
                </th>
                <td mat-cell *matCellDef="let element"> {{ element[column] || '-' }} </td>
              </ng-container>
            }
          }

          <!-- Fila de Encabezado y Filas de Datos -->
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </div>
    } @else {
      <p class="text-center text-gray-500 p-8">No hay documentos de salida para mostrar.</p>
    }
  </mat-card-content>
</mat-card>
